# Stock Master 项目使用指南

## 📋 项目概述

**Stock Master** 是一个面向普通投资者的股票技术分析工具,用通俗易懂的语言解释复杂的技术指标,并给出明确的买卖建议。

### 核心特性

- ✅ **小白友好**: 用日常语言解释 RSI、MACD、KDJ 等专业指标
- ✅ **混合数据源**: Yahoo Finance (实时数据) + Alpha Vantage MCP (专业指标)
- ✅ **多市场支持**: 美股、港股、A股
- ✅ **持仓管理**: Excel 表格管理,自动计算盈亏
- ✅ **飞书同步**: 支持同步到飞书多维表格
- ✅ **形态识别**: K线形态 + 趋势形态自动识别

---

## 🚀 快速开始

### 步骤 1: 安装 Python 依赖

```bash
cd /Users/solaeter/Documents/ldyoung/投资理财/美股管理Agent/stock-master
pip install -r requirements.txt
```

**依赖说明**:
- `yfinance`: 获取 Yahoo Finance 实时价格和历史数据
- `pandas`: 数据处理
- `numpy`: 数值计算
- `openpyxl`: Excel 持仓表格读写

### 步骤 2: 配置文件设置

复制配置模板:
```bash
cp config.example.json config.json
```

编辑 `config.json`:
```json
{
  "portfolio_path": "./my_portfolio.xlsx",
  "feishu_config_path": "./feishu_config.json"
}
```

### 步骤 3: (可选) 配置 Alpha Vantage MCP

如果需要使用专业的 RSI 和布林带指标,可以配置 Alpha Vantage:

1. 获取免费 API Key: https://www.alphavantage.co/support/#api-key
2. 在 Claude Code 中添加 MCP 服务器:
```bash
claude mcp add Alpha-Vantage --transport http --url "https://mcp.alphavantage.co/mcp?apikey=YOUR_API_KEY"
```

> **注意**: 如果不配置 Alpha Vantage,系统会自动使用本地计算,功能完全正常。

### 步骤 4: (可选) 配置飞书同步

如果需要同步到飞书多维表格:

1. 复制飞书配置模板:
```bash
cp feishu_config.example.json feishu_config.json
```

2. 编辑 `feishu_config.json`:
```json
{
  "APP_ID": "cli_xxx",
  "APP_SECRET": "xxx",
  "APP_TOKEN": "xxx",
  "TABLE_ID": "tblxxx"
}
```

详细配置指南: [飞书开放平台文档](https://open.feishu.cn/document/server-docs/docs/bitable-v1/bitable-overview)

---

## 💡 使用方式

### 方式一: 作为 Claude Skill 使用 (推荐)

这个项目已经包含 `SKILL.md` 文件,可以直接作为 Claude Skill 使用。

**在 Claude Code 中直接对话**:
```
分析 AAPL 股票
看看特斯拉能买吗
对比 NVDA 和 AMD
分析我的持仓
```

### 方式二: 直接运行 Python 脚本

#### 分析单只股票
```bash
cd scripts
python main.py AAPL
```

#### 分析港股
```bash
python main.py 0700.HK
```

#### 分析 A股
```bash
python main.py 600519.SS  # 上海股票
python main.py 000001.SZ  # 深圳股票
```

---

## 📊 核心功能详解

### 1. 股票技术分析

**支持的技术指标**:

| 指标 | 数据源 | 说明 |
|------|--------|------|
| RSI | Alpha Vantage / 本地 | 相对强弱指数 |
| MACD | 本地计算 | 趋势动量指标 |
| KDJ | 本地计算 | 随机指标 |
| 布林带 | Alpha Vantage / 本地 | 波动区间 |
| OBV | 本地计算 | 量能指标 |
| ATR | 本地计算 | 动态止损 |
| 斐波那契 | 本地计算 | 支撑阻力位 |

**形态识别**:

K线形态:
- 锤子线、上吊线
- 看涨/看跌吞没
- 早晨之星、黄昏之星
- 三只白兵、三只乌鸦
- 十字星

趋势形态:
- 双底 (W底)、双顶 (M头)
- 头肩底、头肩顶
- 上升三角形、下降三角形

### 2. 交易建议评分系统

| 分数 | 建议 | 仓位 |
|------|------|------|
| ≥6 | 强烈买入 | 30% |
| 3-5 | 建议买入 | 20% |
| -2~2 | 观望 | - |
| -3~-5 | 建议卖出 | - |
| ≤-6 | 强烈卖出 | - |

### 3. 持仓管理

**创建持仓表格**:
```python
from scripts.portfolio import create_portfolio_template
create_portfolio_template('./my_portfolio.xlsx')
```

**更新持仓价格**:
```python
from scripts.portfolio import update_portfolio_prices
update_portfolio_prices('./my_portfolio.xlsx')
```

**股票代码格式**:
- 美股: `AAPL`, `TSLA`, `GOOGL`
- 港股: `0700.HK`, `9988.HK`
- A股: `600519.SS` (上海), `000001.SZ` (深圳)

### 4. 飞书同步

**同步股票分析结果**:
```python
from scripts.feishu_sync import FeishuBitable, sync_stock_signal

bitable = FeishuBitable()
sync_stock_signal(bitable, {
    'ticker': 'AAPL',
    'score': 5,
    'action': '建议买入',
    # ... 其他分析数据
})
```

---

## 📁 项目结构

```
stock-master/
├── SKILL.md                    # Claude Skill 定义
├── README.md                   # 项目说明
├── LICENSE                     # MIT 许可证
├── requirements.txt            # Python 依赖
├── config.example.json         # 配置模板
├── feishu_config.example.json  # 飞书配置模板
├── scripts/                    # 核心脚本
│   ├── main.py                 # 主分析器
│   ├── indicators.py           # 技术指标计算
│   ├── beginner_analyzer.py    # 小白友好报告生成
│   ├── portfolio.py            # 持仓管理
│   ├── feishu_sync.py          # 飞书同步
│   └── feishu_init_tables.py   # 飞书表结构初始化
└── references/                 # 参考文档
    ├── investment-wisdom.md    # 投资智慧与哲学
    ├── portfolio-guide.md      # Excel 持仓管理指南
    ├── feishu-guide.md         # 飞书同步详细指南
    ├── mcp-tools.md            # MCP 工具使用指南
    ├── scripts-guide.md        # 脚本详细说明
    └── changelog.md            # 更新日志
```

---

## 🎯 使用场景示例

### 场景 1: 分析单只股票

**在 Claude Code 中**:
```
分析 AAPL 股票
```

**或直接运行脚本**:
```bash
cd scripts
python main.py AAPL
```

**输出内容**:
- 当前价格和涨跌幅
- RSI、MACD、KDJ 等指标的通俗解释
- K线形态和趋势形态识别
- 支撑位和阻力位
- 综合交易建议和评分
- 动态止损建议

### 场景 2: 对比多只股票

**在 Claude Code 中**:
```
对比 AAPL 和 GOOGL
这几只哪个好: TSLA, NVDA, AMD
```

### 场景 3: 持仓管理

**创建持仓表格**:
```
创建持仓表格
```

**分析持仓**:
```
分析我的持仓
```

**更新持仓价格**:
```
更新持仓价格
```

### 场景 4: 飞书同步

**同步分析结果到飞书**:
```
同步分析结果到飞书
更新飞书持仓
```

---

## 🔍 技术指标小白解读

### RSI (相对强弱指数)
- **< 30**: 超卖 → "大甩卖,可能捡便宜"
- **> 70**: 超买 → "被抢购一空,小心回调"

### MACD
- **金叉**: "踩油门加速,买入信号"
- **死叉**: "松油门减速,卖出警告"

### KDJ (随机指标)
- **金叉/J<0**: "绿灯亮了,短期买入"
- **死叉/J>100**: "红灯亮了,短期卖出"

### 布林带
- **跌破下轨**: "橡皮筋拉太长,可能反弹"
- **突破上轨**: "涨过头了,可能回落"

### 背离信号
- **底背离**: 价格创新低但动能减弱,反弹信号
- **顶背离**: 价格创新高但动能减弱,回调信号

---

## ⚠️ 风险提示

> **免责声明**: 本工具仅供学习和参考,不构成投资建议。
>
> - 股市有风险,投资需谨慎
> - 技术分析不能保证盈利
> - 请根据自身情况做出决策
> - 建议分批建仓,设置止损

---

## 📚 进阶阅读

- [投资智慧与哲学](references/investment-wisdom.md) - 股民十大境界、交易原则、心态修炼
- [Excel 持仓管理指南](references/portfolio-guide.md) - 详细的持仓表格使用说明
- [飞书同步指南](references/feishu-guide.md) - 飞书多维表格配置与同步
- [MCP 工具使用](references/mcp-tools.md) - Alpha Vantage API 调用指南
- [脚本详细说明](references/scripts-guide.md) - 各个 Python 脚本的详细文档

---

## 🤝 贡献与支持

- **GitHub**: https://github.com/EagleF6432614/stock-master
- **许可证**: MIT License
- 欢迎提交 Issue 和 Pull Request
- 如果觉得有用,请给个 Star ⭐

---

## 💬 常见问题

### Q1: 必须配置 Alpha Vantage 吗?
**A**: 不是必须的。如果不配置,系统会自动使用本地计算,功能完全正常。Alpha Vantage 只是提供更专业的 RSI 和布林带数据。

### Q2: 支持哪些市场的股票?
**A**: 支持美股、港股、A股。使用正确的股票代码格式即可:
- 美股: `AAPL`
- 港股: `0700.HK`
- A股: `600519.SS` (上海) 或 `000001.SZ` (深圳)

### Q3: 如何理解交易建议评分?
**A**: 评分范围从 -10 到 +10:
- ≥6: 强烈买入
- 3-5: 建议买入
- -2~2: 观望
- -3~-5: 建议卖出
- ≤-6: 强烈卖出

### Q4: 持仓表格存在哪里?
**A**: 默认在项目根目录的 `my_portfolio.xlsx`,可以在 `config.json` 中自定义路径。

### Q5: 飞书同步是必须的吗?
**A**: 不是必须的。飞书同步是可选功能,如果不需要可以不配置。
